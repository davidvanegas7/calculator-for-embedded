<style>
	body{
		font-family: Roboto,sans-serif;
	    background-color: #f5f5f5;
	}

	.sub-header{
		padding: 20px;
		width: 100%;
		display: inline-block;
		overflow-x: auto;
	    white-space: nowrap;
	    padding-left: 10px;
	    min-height: 40px;
	    text-align: center;
	    background: #2a3249;
	}

	.sub-header > a {
		color: grey;
		padding: 0 10px;	
		text-decoration: none;
	}


	.sub-header > a.linked {
		color: white;
		padding: 0 10px;	
		text-decoration: none;
	}

	#div1{
		margin: 25px auto;
	    width: 85%;
	    border-radius: 5px;
	    padding: 15px;
	    margin-bottom: 20px;
	    border-radius: 0;
	    background-color: #FFF;
	    box-shadow: 0 2px 2px 0 rgba(0,0,0,.16),0 0 2px 0 rgba(0,0,0,.12);
	    
	    padding-left: 20px;
	    padding-bottom: 15px;
	    float: left;
	    display: flex;
	}

	.calculator-form{
		width: 60%;
	}


	#boxes{
		width: 40%;
	}

	.mui-textfield label, .box-title{
		font-weight: bold;
	}

	.formatted-input-container .mui-textfield{
		display: table-caption;
	}

	.formatted-input-container{
	    display: inline;
	    width: 50%;
	    text-align: center;
	}

	.or{
		width: 5%;
		display: inline;
	}

	.hidden{
		display: none;
	}
</style>
<div id="page">
	<div id="div1">
	<form class="calculator-form" _lpchecked="1">
		<h2 class="calculator-title">DSCR and Balance</h2>
		<h4>Calculate my monthly mortgage payments and debt-service coverage ratio</h4>
		<div class="margin-top"></div>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">Loan Amount</label>
				<input type="text" name="loanAmount" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>
		<p class="or"> </p>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">Initial Rate</label>
				<input type="text" name="interestRate" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>
		<br><br>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">(Initial Term) Yrs</label>
				<input type="text" name="initialTerm" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>
		<p class="or"> </p>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">(Interest Only) Yrs</label>
				<input type="text" name="interestOnly" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>
		<br><br>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">Amortization Years</label>
				<input type="text" name="amortizationYears" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>
		<p class="or">or</p>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">Amortization Months</label>
				<input type="text" name="amortizationMonths" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>
		<br><br>
		<div class="formatted-input-container">
			<div class="mui-textfield">
				<label style="transition: 0.15s ease-out;">Annual Underwritten NOI</label>
				<input type="text" name="annualUnderwrittenNOI" value="" class="mui--is-empty mui--is-dirty">
			</div>
		</div>

		<br>
		<br>
		<b>Values for test:</b> - 
		<b>Loan Amount:</b> 100000 -
		<b>Initial Rate:</b> 1 -
		<b>(Initial Term) Yrs:</b> 10 -
		<b>Amortization Years:</b> 1 <b>or</b> <b>Amortization Months:</b> 12
		<b>Annual Underwritten NOI:</b> Not necessary<br>

		</form>
		<div id="boxes">
			<p class="hidden"><i class="material-icons">share</i><!-- react-text: 187 -->Share Calculations<!-- /react-text --></p>
			<div class="box">
			<p class="box-title">Monthly Payments</p>
			<p class="amount">
				<span class="display-value" name="monthlyPaymentsAmortizationPeriod">$0</span>
			</p>
			</div>
			<div class="box">
				<p class="box-title">Annual Payments</p>
				<p class="amount">
					<span class="display-value" name="annualPaymentsAmortizationPeriod">$0</span>
				</p>
			</div>
			<div class="box orange">
				<p class="box-title">Balance at Maturity</p>
				<p class="amount">
					<span class="display-value" name="balanceAtMaturity">$0</span>
				</p>
			</div>
			<div class="box orange">
				<p class="box-title">Debt Service Coverage Ratio</p>
				<p class="amount">
					<span class="display-value" name="debtServiceCoverageRatio">0</span>
				</p>
			</div>
		</div>
	</div>


</div>
<script>
const

	$div1 = document.getElementById("div1"),
	$div2 = document.getElementById("div2");


	$loanAmountObject = document.getElementsByName("loanAmount")[0];
	$interestRateObject = document.getElementsByName("interestRate")[0];
	$initialTermObject = document.getElementsByName("initialTerm")[0];
	$interestOnlyObject = document.getElementsByName("interestOnly")[0];
	$amortizationYearsObject = document.getElementsByName("amortizationYears")[0];
	$amortizationMonthsObject = document.getElementsByName("amortizationMonths")[0];
	$annualUnderwrittenNOIObject = document.getElementsByName("annualUnderwrittenNOI")[0];

	$monthlyPaymentsAmortizationPeriodObject = document.getElementsByName("monthlyPaymentsAmortizationPeriod")[0];
	$annualPaymentsAmortizationPeriodObject = document.getElementsByName("annualPaymentsAmortizationPeriod")[0];
	$balanceAtMaturityObject = document.getElementsByName("balanceAtMaturity")[0];
	$debtServiceCoverageRatioObject = document.getElementsByName("debtServiceCoverageRatio")[0];


	$loanAmountObject.addEventListener("keyup", changeActions);
	$interestRateObject.addEventListener("keyup", changeActions);
	$initialTermObject.addEventListener("keyup", changeActions);
	$interestOnlyObject.addEventListener("keyup", changeActions);
	$amortizationYearsObject.addEventListener("keyup", changeActions);
	$amortizationMonthsObject.addEventListener("keyup", changeActions);
	$annualUnderwrittenNOIObject.addEventListener("keyup", changeActions);


	function changeActions() {
		var t = this;
		var $loanAmount = $loanAmountObject.value;
		$loanAmount = $loanAmount.replace("$","");
		$loanAmount = $loanAmount.replace(",","");
		$loanAmount = $loanAmount.replace(".",",");
		var $interestRate = $interestRateObject.value;
		$interestRate = $interestRate.replace("%","");

		var $initialTerm = $initialTermObject.value;
		var $interestOnly = $interestOnlyObject.value;
		var $amortizationYears = $amortizationYearsObject.value;
		var $amortizationMonths = $amortizationMonthsObject.value;
		var $annualUnderwrittenNOI = $annualUnderwrittenNOIObject.value;
		$annualUnderwrittenNOI = $annualUnderwrittenNOI.replace("$","");
		$annualUnderwrittenNOI = $annualUnderwrittenNOI.replace(",","");
		$annualUnderwrittenNOI = $annualUnderwrittenNOI.replace(".",",");

		var $monthlyPaymentsAmortizationPeriod = $monthlyPaymentsAmortizationPeriodObject.value;
		var $annualPaymentsAmortizationPeriod = $annualPaymentsAmortizationPeriodObject.value;
		var $balanceAtMaturity = $balanceAtMaturityObject.value;
		var $debtServiceCoverageRatio = $debtServiceCoverageRatioObject.value;


	    if ("amortizationYears" === t.name ? ($amortizationYears = t.value, $amortizationMonths = 12 * t.value) : "amortizationMonths" === t.name && ($amortizationMonths = t.value, $amortizationYears = t.value / 12), $loanAmount.length && $interestRate && ($amortizationMonths || $amortizationYears)) {
	        var n = $loanAmount * ($interestRate / 1200) * Math.pow(1 + $interestRate / 1200, $amortizationMonths),
	            a = Math.pow(1 + $interestRate / 1200, $amortizationMonths) - 1;
	        if ($monthlyPaymentsAmortizationPeriod = n / a, $annualPaymentsAmortizationPeriod = n / a * 12, $interestOnly ? ($monthlyPaymentsInterestOnlyPeriod = $loanAmount * ($interestRate / 100) / 12, $annualPaymentsInterestOnlyPeriod = 12 * $monthlyPaymentsInterestOnlyPeriod) : ($monthlyPaymentsInterestOnlyPeriod = 0, $annualPaymentsInterestOnlyPeriod = 0), $initialTerm) {
	            var r = $interestRate / 100 / 12,
	                o = 12 * $initialTerm,
	                i = 12 * $interestOnly,
	                s = $loanAmount * Math.pow(1 + r, o - i),
	                l = r * $loanAmount / (1 - Math.pow(1 + r, -$amortizationMonths)) / r * (Math.pow(1 + r, o - i) - 1);
	            $balanceAtMaturity = s - l
	        } else $balanceAtMaturity = 0;
	        $annualUnderwrittenNOI ? $debtServiceCoverageRatio = $annualUnderwrittenNOI / (12 * $monthlyPaymentsAmortizationPeriod) : $debtServiceCoverageRatio = 0
	    } else $monthlyPaymentsAmortizationPeriod = 0, $annualPaymentsAmortizationPeriod = 0, $monthlyPaymentsInterestOnlyPeriod = 0, $annualPaymentsInterestOnlyPeriod = 0, $balanceAtMaturity = 0, $debtServiceCoverageRatio = 0


		$loanAmountObject.value = ($loanAmount==0)?"":"$"+numberWithCommas($loanAmount);
		$interestRateObject.value = ($interestRate==0)?"":$interestRate+"%";
		$initialTermObject.value = $initialTerm;
		$interestOnlyObject.value = $interestOnly;
		$amortizationYearsObject.value = ($amortizationYears==0)?"":$amortizationYears;
		$amortizationMonthsObject.value = ($amortizationMonths==0)?"":$amortizationMonths ;
		$annualUnderwrittenNOIObject.value = ($annualUnderwrittenNOI==0)? "":"$"+numberWithCommas($annualUnderwrittenNOI);
		$monthlyPaymentsAmortizationPeriodObject.innerHTML = ($monthlyPaymentsAmortizationPeriod==0)? "$0":"$"+numberWithCommas((parseFloat($monthlyPaymentsAmortizationPeriod)).toFixed(2));
		$annualPaymentsAmortizationPeriodObject.innerHTML =  ($annualPaymentsAmortizationPeriod==0)? "$0":"$"+ numberWithCommas((parseFloat($annualPaymentsAmortizationPeriod)).toFixed(2));
		$balanceAtMaturityObject.innerHTML =  ($balanceAtMaturity==0)? "$0":"$"+ numberWithCommas((parseFloat($balanceAtMaturity)).toFixed(2));
		$debtServiceCoverageRatioObject.innerHTML = numberWithCommas((parseDouble($debtServiceCoverageRatio)).toFixed(3));
	}

	function numberWithCommas(x) {
	    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
	}
</script>